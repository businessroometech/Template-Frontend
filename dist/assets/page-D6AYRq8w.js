import{r as o,b as C,u as I,e3 as R,e4 as T,br as Y,bs as j,bt as A,bK as B,a as V,j as e,bE as $,e5 as q,L as c,B as z,aI as D,K as J,aJ as K,aH as O,c as U}from"./index-Cw_JW-sQ.js";import{P as _}from"./PasswordFormInput-CuhHNbTV.js";import{A as H}from"./AuthLayout-xbMKzgn4.js";const M=()=>{const[t,r]=o.useState(!1),[n,v]=o.useState(""),[y,w]=o.useState(""),d=C(),{saveSession:N}=I(),[S]=R(),{showNotification:i}=T(),E=Y({email:j().email("Please Enter a Valid Email").required("Please Enter Your Email"),password:j().required("Please Enter Your Password")}),{control:L,handleSubmit:P,getValues:m,watch:g}=A({resolver:B(E),defaultValues:{email:"",password:""}});o.useEffect(()=>{v(m().email),w(m().password)},[g("email"),g("password")]);const F=()=>{const a=S.get("redirectTo");d(a||"/")},k=P(async()=>{var u,p,h,x,b,f;r(!0);const a={email:n,password:y};console.log(a);try{const s=await(await fetch(`${V}api/v1/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();console.log(s),(u=s==null?void 0:s.data)!=null&&u.accessToken?(N((p=s==null?void 0:s.data)==null?void 0:p.user),F(),i({message:"Successfully logged in. Redirecting....",variant:"success"})):(s==null?void 0:s.status)==="error"?i({message:s.message,variant:"danger"}):i({message:s.message||"Login Failed...",variant:"danger"})}catch(l){(x=(h=l.response)==null?void 0:h.data)!=null&&x.error&&i({message:(f=(b=l.response)==null?void 0:b.data)==null?void 0:f.message,variant:"danger"})}finally{r(!1)}});return{loading:t,login:k,control:L}},G=()=>{const{loading:t,login:r,control:n}=M();return e.jsxs("form",{className:"mt-sm-4",onSubmit:r,children:[e.jsx($,{name:"email",type:"email",placeholder:"Enter Your Email",control:n,containerClassName:"mb-3 input-group-lg"}),e.jsx("div",{className:"mb-3 position-relative",children:e.jsx(_,{name:"password",placeholder:"Enter Your Password",control:n,size:"lg",containerClassName:"w-100"})}),e.jsxs("div",{className:"mb-3 d-sm-flex justify-content-between",children:[e.jsx("div",{children:e.jsx(q,{type:"checkbox",label:"Remember me?",id:"rememberCheck"})}),e.jsx(c,{to:"/auth/forgot-pass",children:"Forgot password?"})]}),e.jsx("div",{className:"d-grid",children:e.jsx(z,{variant:"primary",size:"lg",type:"submit",disabled:t,children:t?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Logging in..."]}):"Login"})}),e.jsxs("p",{className:"mb-0 mt-3",children:["Â©",D,e.jsx(c,{target:"_blank",to:J,style:{marginRight:"5px"},children:K}),"All rights reserved"]})]})},Z=()=>e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Sign In"}),e.jsx(H,{children:e.jsxs(U,{className:"card-body text-center p-4 p-sm-5",children:[e.jsx("h1",{className:"mb-2",children:"Sign in"}),e.jsxs("p",{className:"mb-0",children:["Don't have an account?",e.jsx(c,{to:"/auth/sign-up",children:" Click here to sign up"})]}),e.jsx(G,{})]})})]});export{Z as default};
