import{r as n,br as R,bs as l,dh as T,b as O,u as Y,bt as $,bK as _,j as o,c as q,d as z,f as H,di as J,cV as L,bE as d,dj as V,C as j,dk as G,bW as K,bb as w,w as v,B as W,dl as y,aH as Q}from"./index-Cw_JW-sQ.js";const X=()=>{var g,b;const[r,P]=n.useState({}),C=R({fName:l(),lName:l(),occupation:l(),dob:T(),email:l(),gender:l()}),k=O(),[u,f]=n.useState(!1),{user:e,saveSession:U}=Y();console.log("profile in account settings",(g=r==null?void 0:r.personalDetails)==null?void 0:g.gender);const{control:s,handleSubmit:F}=$({resolver:_(C),defaultValues:{fName:e==null?void 0:e.firstName,lName:e==null?void 0:e.lastName,email:e==null?void 0:e.emailAddress,occupation:e==null?void 0:e.userRole,gender:(b=r==null?void 0:r.personalDetails)==null?void 0:b.gender,dob:e==null?void 0:e.dob}}),[c,I]=n.useState([]),[i,S]=n.useState([]);console.log("---upf---",c),console.log("---upbgf---",i);const D=a=>{I(a)},B=a=>{S(a)},E=async()=>{if(!c||c.length===0)return console.log("went in"),"";try{const a=await y(c,e==null?void 0:e.id);return console.log("---- response in the upload doc function ----",a),a}catch(a){return console.error("Error in the createpostcard:",a),!1}},A=async()=>{if(!i||i.length===0)return"";try{const a=await y(i,e==null?void 0:e.id);return console.log("---- response in the upload doc function ----",a),a}catch(a){return console.error("Error in the createpostcard:",a),!1}},M=async a=>{f(!0),console.log("----data----",a);try{const t=await E(),p=await A(),x={occupation:a.occupation,userId:e==null?void 0:e.id,profilePictureUploadId:t,bgPictureUploadId:p,firstName:a.fName,lastName:a.lName,dob:a.dob,emailAddress:a.email,gender:a.gender,bodyMeasurement:"38-32-40",aadharNumberUploadId:"111e2227-c34d-78d3-e456-426614174333",panNumberUploadId:"222e3337-d45e-89d3-f456-426614174444"};console.log("Request body:",x);const N=await fetch("https://app-backend-8r74.onrender.com/api/v1/auth/update-or-create-Profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)});if(!N.ok)throw new Error("Network response was not ok");const m=await N.json();console.log(m);for(const h in m)e[h]&&(e[h]=m[h]);U(e),k("/")}catch(t){console.error("Error updating profile:",t)}finally{f(!1)}};return n.useEffect(()=>{(async()=>{try{const t=await fetch("https://app-backend-8r74.onrender.com/api/v1/auth/get-user-Profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e==null?void 0:e.id})});if(!t.ok)throw new Error("Network response was not ok");const p=await t.json();P(p.data)}catch(t){console.error("Error fetching user profile:",t)}})()},[e==null?void 0:e.id]),o.jsxs(q,{children:[o.jsx(z,{children:o.jsx("h5",{className:"card-title",children:"Basic Profile"})}),o.jsx(H,{children:o.jsxs("form",{onSubmit:F(M),className:"row g-3",children:[o.jsx("div",{className:"h-50px",style:{backgroundImage:`url(${r.coverImgUrl||J})`,backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}}),o.jsx("div",{className:"text-center mt-3",children:o.jsx("div",{className:"avatar avatar-lg mt-n5 mb-3",children:o.jsx("img",{height:64,width:64,src:r.profileImgUrl||L,alt:"avatar",className:"avatar-img rounded border border-white border-3"})})}),o.jsx(d,{name:"fName",label:"First Name",control:s,containerClassName:"col-6"}),o.jsx(d,{name:"lName",label:"Last Name",control:s,containerClassName:"col-6"}),o.jsx(d,{name:"occupation",label:"Role",control:s,containerClassName:"col-12"}),o.jsx(V,{name:"gender",label:"Gender",control:s,containerClassName:"col-12",options:[{value:"male",label:"Male"},{value:"female",label:"Female"},{value:"prefer_not_to_say",label:"Prefer not to say"}]}),o.jsxs(j,{xs:12,children:[o.jsx("label",{className:"form-label",children:"Date of Birth"}),o.jsx(G,{name:"dob",control:s,render:({field:a})=>o.jsx(K,{...a,placeholder:"YYYY-MM-DD",className:"form-control"})})]}),o.jsx(d,{name:"email",label:"Email",control:s,containerClassName:"col-12"}),o.jsx(w,{icon:v,onFileUpload:B,showPreview:!0,text:"Drag here or click to upload Cover photo"}),o.jsx(w,{icon:v,onFileUpload:D,showPreview:!0,text:"Drag here or click to upload profile photo."}),o.jsx(j,{xs:12,className:"mt-3",children:o.jsx(W,{type:"submit",disabled:u,children:u?o.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):"Update Profile"})})]})})]})},ee=()=>o.jsxs(o.Fragment,{children:[o.jsx(Q,{title:"Account Settings"}),o.jsx(X,{})]});export{ee as default};
