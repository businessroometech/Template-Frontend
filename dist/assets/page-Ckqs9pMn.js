import{W as N,j as s,B as i,Q as j,u,r as l,aH as g,X as y,R as v,C as b,c as w,d as C,E as d,G as m,ar as x,I as h,O as t,bA as B,bm as p,l as k,f as T,L as D,ao as z,a6 as E,bj as A,e2 as L,a5 as S}from"./index-Cw_JW-sQ.js";const M=()=>{const{isTrue:a,toggle:r}=N();return s.jsxs(i,{onClick:r,variant:"primary-soft",role:"button",className:j("btn-loader",{active:a}),"data-bs-toggle":"button","aria-pressed":"true",children:[s.jsx("span",{className:"load-text",children:" Load more notifications"}),s.jsx("div",{className:"load-icon",children:s.jsx("div",{className:"spinner-grow spinner-grow-sm",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})})})]})},R=()=>{const{user:a}=u(),[r,f]=l.useState([]);l.useEffect(()=>{a!=null&&a.id&&c()},[a]);const c=async()=>{try{const n=await(await fetch("https://app-backend-8r74.onrender.com/api/v1/notifications/fetch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a==null?void 0:a.id})})).json();n!=null&&n.notifications&&f(n.notifications)}catch(e){console.error("Error fetching notifications:",e)}},o=async e=>{try{await fetch("https://app-backend-8r74.onrender.com/api/v1/notifications/mark-as-read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationId:e})}),c()}catch(n){console.error("Error marking notification as read:",n)}};return s.jsxs(s.Fragment,{children:[s.jsx(g,{title:"Notifications"}),s.jsx("main",{children:s.jsx(y,{children:s.jsx(v,{className:"g-4",children:s.jsx(b,{lg:8,className:"mx-auto",children:s.jsxs(w,{children:[s.jsxs(C,{className:"py-3 border-0 d-flex align-items-center justify-content-between",children:[s.jsx("h1",{className:"h5 mb-0",children:"Notifications"}),s.jsxs(d,{children:[s.jsx(m,{as:"a",className:"text-secondary btn btn-secondary-soft-hover py-1 px-2",id:"cardNotiAction","aria-expanded":"false",children:s.jsx(x,{})}),s.jsxs(h,{className:"dropdown-menu-end",children:[s.jsxs(t,{onClick:()=>r.forEach(e=>o(e.id)),children:[s.jsx(B,{size:22,className:"fa-fw pe-2"}),"Mark all read"]}),s.jsxs(t,{children:[s.jsx(p,{size:22,className:"fa-fw pe-2"}),"Push notifications"]}),s.jsxs(t,{children:[s.jsx(k,{size:22,className:"fa-fw pe-2"}),"Email notifications"]})]})]})]}),s.jsx(T,{className:"p-2",children:s.jsx("ul",{className:"list-unstyled",children:r==null?void 0:r.map(e=>s.jsx(D,{to:e.navigation,children:s.jsxs("div",{onClick:()=>o(e.id),className:j("rounded d-sm-flex border-0 mb-1 p-3 position-relative cursor-pointer",{"badge-unread":!e.isRead}),children:[s.jsx("div",{className:"avatar text-center",children:e.avatar?s.jsx("img",{className:"avatar-img rounded-circle",src:e.avatar,alt:e.avatar}):s.jsx("img",{className:"avatar-img rounded-circle",src:z,alt:"Avatar"})}),s.jsxs("div",{className:"mx-sm-3 my-2 my-sm-0",children:[s.jsx("p",{className:"small mb-2 text-secondary",children:e.message}),e.type==="isFriendRequest"&&s.jsxs("div",{className:"d-flex",children:[s.jsx(i,{variant:"primary",size:"sm",className:"py-1 me-2",children:"Accept"}),s.jsx(i,{variant:"danger-soft",size:"sm",className:"py-1",children:"Delete"})]})]}),s.jsxs("div",{className:"d-flex ms-auto",children:[s.jsx("p",{className:"small me-5 text-nowrap",children:E(new Date(e.createdAt))}),s.jsxs(d,{className:"position-absolute end-0 top-0 mt-3 me-3",children:[s.jsx(m,{as:"a",className:"text-secondary btn position-relative py-0 px-2","aria-expanded":"false",children:s.jsx(x,{})}),s.jsxs(h,{className:"dropdown-menu-end",children:[s.jsxs(t,{children:[s.jsx(A,{size:22,className:"fa-fw pe-2"}),"Delete"]}),s.jsxs(t,{children:[s.jsx(p,{size:22,className:"fa-fw pe-2"}),"Turn off"]}),s.jsxs(t,{children:[s.jsx(L,{size:22,className:"fa-fw pe-2"}),"Mute"]})]})]})]})]})},e.id))})}),s.jsx(S,{className:"border-0 py-3 text-center",children:s.jsx(M,{})})]})})})})})]})};export{R as default};
