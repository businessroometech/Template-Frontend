import{u as g,r as c,j as s,E as j,G as f,t as u,I as N,c as y,d as b,L as t,f as d,Q as v,ao as w,B as l,a6 as k,a5 as C,d7 as S,dU as T}from"./index-Cw_JW-sQ.js";import{L as B}from"./LogoBox-Y-EU6mcb.js";import{S as z,M as A,C as D,P as E}from"./StyledHeader-ClugDEIJ.js";import"./change-casing-CelTTBkY.js";import"./OverlayTrigger-D6FT952t.js";const O=()=>{const{user:n}=g(),[r,m]=c.useState([]);c.useEffect(()=>{n!=null&&n.id&&o()},[n]);const o=async()=>{try{const a=await(await fetch("https://app-backend-8r74.onrender.com/api/v1/notifications/fetch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n==null?void 0:n.id})})).json();a!=null&&a.notifications&&m(a.notifications)}catch(e){console.error("Error fetching notifications:",e)}},p=async e=>{try{await(await fetch("https://app-backend-8r74.onrender.com/api/v1/notifications/mark-as-read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationId:e})})).json(),o()}catch(a){console.error("Error marking notification as read:",a)}},h=async()=>{try{const e=r.map(x=>x.id),i=await(await fetch("https://app-backend-8r74.onrender.com/api/v1/notifications/mark-all-as-read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:e})})).json();i!=null&&i.success?(console.log("All notifications marked as read successfully."),o()):console.error("Failed to mark all notifications as read:",i.message)}catch(e){console.error("Error marking all notifications as read:",e)}};return s.jsxs(j,{as:"li",autoClose:"outside",className:"nav-item ms-2",drop:"down",align:"end",children:[s.jsxs(f,{className:"content-none nav-link bg-light icon-md btn btn-light p-0",children:[s.jsx("span",{className:"badge-notif animation-blink"}),s.jsx(u,{size:15})]}),s.jsx(N,{className:"dropdown-animation dropdown-menu-end dropdown-menu-size-md p-0 shadow-lg border-0",children:s.jsxs(y,{children:[s.jsxs(b,{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("h6",{className:"m-0",children:["Notifications"," ",s.jsxs("span",{className:"badge bg-danger bg-opacity-10 text-danger ms-2",children:[r.filter(e=>!e.isRead).length," new"]})]}),s.jsx(t,{className:"small",to:"#",onClick:h,children:"read all"})]}),s.jsx(d,{className:"p-0",children:s.jsx("ul",{className:"list-group list-group-flush list-unstyled p-2",children:s.jsx(d,{className:"p-0",children:s.jsx("ul",{className:"list-group list-group-flush list-unstyled p-2",children:r.slice(0,4).map(e=>s.jsx(t,{to:e.navigation,children:s.jsxs("div",{onClick:()=>p(e.id),className:v("rounded d-sm-flex border-0 mb-1 p-3 pt-4 position-relative cursor-pointer",{"badge-unread":!e.isRead}),children:[s.jsx("div",{className:"avatar text-center",children:s.jsx("img",{className:"avatar-img rounded-circle",src:e.avatar||w,alt:"Avatar"})}),s.jsxs("div",{className:"ms-3 my-2 my-sm-0  position-relative",children:[s.jsx("p",{className:"small mb-2 pb-2 text-secondary",children:e.message}),e.type==="isFriendRequest"&&s.jsxs("div",{className:"d-flex mt-2",children:[s.jsx(l,{variant:"primary",size:"sm",className:"py-1 me-2",children:"Accept"}),s.jsx(l,{variant:"danger-soft",size:"sm",className:"py-1",children:"Delete"})]})]}),s.jsxs("p",{className:"small text-nowrap ",style:{padding:"10px",top:"-.5em",right:"0",position:"absolute"},children:[k(new Date(e.createdAt))," ago"]})]})},e.id))})})})}),s.jsx(C,{className:"text-center",children:s.jsx(t,{to:"/notifications",children:s.jsx(l,{variant:"primary-soft",size:"sm",children:"See all incoming activity"})})})]})})]})},H=()=>s.jsx(z,{children:s.jsxs("div",{className:"container",children:[s.jsx(B,{}),s.jsx(A,{}),s.jsx(D,{isSearch:!0}),s.jsxs("ul",{className:"nav flex-nowrap align-items-center ms-sm-3 list-unstyled",children:[s.jsx("li",{className:"nav-item ms-2",children:s.jsx(t,{className:"nav-link bg-light icon-md btn btn-light p-0",to:"/messaging",children:s.jsx(S,{size:15})})}),s.jsx("li",{className:"nav-item ms-2",children:s.jsx(t,{className:"nav-link bg-light icon-md btn btn-light p-0",to:"/settings/account",children:s.jsx(T,{size:15})})}),s.jsx(O,{}),s.jsx(E,{})]})]})});export{H as default};
